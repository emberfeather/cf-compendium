(function(a){function e(b,c){var d=b.parent(".element"),d=a(".modifiers",d);d.length||(d=a("<span />").addClass("modifiers"),b.after(d));d.append(c)}function f(b){var c=a("<button />",{text:"Remove"}).button({icons:{primary:"ui-icon-circle-minus"},text:!1}).addClass("delete");c[0].setAttribute("type","button");a(".allowDeletion",b).each(function(){e(a(this),c.clone(!0))})}function g(b){var c=a("<button />",{text:"Add multiple"}).button({icons:{primary:"ui-icon-circle-plus"},text:!1}).addClass("duplicate");
c[0].setAttribute("type","button");a(".allowDuplication",b).each(function(){e(a(this),c.clone(!0))})}function h(b,c){adjust=function(b,a){if(a!==void 0)return a===""?"":a+"-"+c};a("[id], [name], [for]",b).attr("id",adjust).attr("name",adjust).attr("for",adjust)}function i(){var b=a(this);b.autocomplete({source:b.data("options"),minLength:b.data("minLength")||0,delay:b.data("delay")||300})}a(function(){var b=a(".form .element");f(b);g(b);a(b).live({"delete":function(){a(this).removeElement()},duplicate:function(){a(this).duplicateElement()}});
a("button.delete",b).live({click:function(){a(this).trigger("delete");return!1}});a("button.duplicate",b).live({click:function(){a(this).trigger("duplicate");return!1}});a(".modifiers",b).buttonset();b.find(".autocomplete").each(i).end();a('input[type="date"]',b).datepicker({dateFormat:"yy-mm-dd"})});a.fn.duplicateElement=function(){return this.each(function(){var b=a(this),c=b.clone().addClass("clone");b.data("cloneLength",(b.data("cloneLength")||0)+1);b.data("cloneCount",(b.data("cloneCount")||
0)+1);c.data("original",b);a(".allowDuplication",c).removeClass("allowDuplication");a(".duplicate",c).remove();a("input[type=text], input[type=password], input[type=file]",c).val("");h(c,"clone"+b.data("cloneCount"));b.after(c);c.trigger("afterduplicate",{original:b});a("input",c).focus()})};a.fn.removeElement=function(){return this.each(function(){current=a(this);if(a(".confirm",current).length&&(confirmMsg="Are you sure you want to remove this?",!confirm(confirmMsg)))return;current.hasClass("clone")&&
(original=current.data("original"),original.data("cloneLength",(original.data("cloneLength")||0)-1));current.remove()})}})(jQuery);
