(function(a){function f(b,c){adjust=function(d,e){if(e!=undefined)return e==""?"":e+"-"+c};a("[id], [name], [for]",b).attr("id",adjust).attr("name",adjust).attr("for",adjust)}a(function(){var b=a(".form .element"),c=a("<a />",{href:"#",click:function(){a(this).parent(".element").duplicateElement();return false},className:"duplicate"});c.append(a("<img />",{src:"/cf-compendium/img/icon/famfamfam/silk/add.png",title:"Add multiple"}));var d=a("<a />",{href:"#",click:function(){a(this).parent(".element").removeElement();
return false},className:"delete"});d.append(a("<img />",{src:"/cf-compendium/img/icon/famfamfam/silk/delete.png",title:"Remove"}));a(".allowDuplication",b).each(function(){a(this).after(c.clone(true))});a(".allowDeletion",b).each(function(){a(this).after(d.clone(true))})});a.fn.duplicateElement=function(){return this.each(function(){original=a(this);clone=a(this).clone(true).addClass("clone");original.data("cloneLength",(original.data("cloneLength")||0)+1);original.data("cloneCount",(original.data("cloneCount")||
0)+1);clone.data("original",original);a(".allowDuplication",clone).removeClass("allowDuplication");a(".duplicate",clone).remove();a("input[type=text], input[type=password], input[type=file]",clone).val("");f(clone,"clone"+original.data("cloneCount"));a(this).after(clone);a("input",clone).focus()})};a.fn.removeElement=function(){return this.each(function(){current=a(this);if(a(".confirm",current).length){confirmMsg="Are you sure you want to remove this?";if(!confirm(confirmMsg))return}if(current.hasClass("clone")){original=
current.data("original");original.data("cloneLength",(original.data("cloneLength")||0)-1)}current.remove()})}})(jQuery);
